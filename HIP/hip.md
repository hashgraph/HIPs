- hip: XX
- title: Wallet connect experience
- author: [0xJepsen](https://github.com/0xJepsen), [rocketmay](https://github.com/rocketmay)
- type: Standards Track
- category: Application
- status: Draft 
- created: <07/03/21>
- discussions-to: <https://github.com/hashgraph/hedera-improvement-proposal/discussions/98>
- updated: <07/03/21>
- requires: <HIP number(s)>
- replaces: <HIP number(s)>
- superseded-by: <HIP number(s)>

## Abstract

This specification proposes a standardized way for wallets to send and receive API calls from a Hedera dApp. This allows users to request transactions which are then generated by the application and presented to them for signing in wallet, without exposing sensitive information to the dApp. 

## Motivation

Developers are currently creating web auth mechanisms from scratch for Hedera-based web apps. This is limiting consumer adoption and resulting in a poor user and developer experience. 
A standard protocol for decentralized applications to communicate with the client and allow clients to authorize actions with their wallets would greatly inprove the developer and user experience. 
The Hedera development space is still young, with many new projects developing promising ideas. Before long, these projects will need to have a standardized method of communication, much like what exists in the Ethereum space.

Taking the Metamask wallet as an example, Metamask offers a seamless way for users to interact with dApps, sending requests and signing transactions without compromising the security of their accounts. Note that Metamask offers a full pathway for connecting the wallet to dApps, including features such as onboarding which would not apply to this HIP.

Without a communication standard, projects in the space are more or less required to implement their own wallets in order to allow users to sign for transactions and services. This not only adds overhead for the project team, but it represents risk to the user who must reveal sensitive account information to these projects.

## Rationale

We propose establishing a standard for applications to provide REST end points based on the Hedera SDK documentation[1].

REST is a flexible and universal client-server communication API that is already in use by the Hedera SDK for communicating with mirror nodes. Building on this to allow wallets and other client applications to communicate with other applications is straightforward.

The Hedera SDK provides a template for function names and data structures which can be followed to simplify design decisions.

## Specification

JavaScript is the primary langauage that can communicate with the browsers [DOM](https://www.w3.org/TR/REC-DOM-Level-1/introduction.html#) , as such it will be nessesary for dapps to utilize the JavaScript SDK.

A new RPC method incorperated into the existing SDK `requestAccounts` is preposed. Calling this method may trigger a user interface that allows the user to approve or reject account acces for a given dapp. This method returns a `Promise` that is resolved with and `Array` of accounts or is rejected with and `Error` if accounts are not available.
  
  `Hedera.requestAccounts`
  
### Protocol

```START dapp
IF provider is defined
    REQUEST[1] account access
    IF user approves
        RESOLVE[2] account access
        CONTINUE dapp
    IF user rejects
        REJECT[3] account access
        STOP dapp
IF provider is undefined
    STOP dapp
  ```

## Backwards Compatibility

This implementation will not effect prior solutions and is fully backwards compatible

## Security Implications

The permissions schema refrenced below in the Open Issues section would provide more robust security for users.

## How to Teach This

Small simple examples and Guides could be incorperated into the existing Hedera documentation.

## Reference Implementation

The reference implementation must be complete before any HIP is given the status of “Final”. The final implementation must include test code and documentation.

## Rejected Ideas

Throughout the discussion of a HIP, various ideas will be proposed which are not accepted. Those rejected ideas should be recorded along with the reasoning as to why they were rejected. This both helps record the thought process behind the final version of the HIP as well as preventing people from bringing up the same rejected idea again in subsequent discussions.

In a way, this section can be thought of as a breakout section of the Rationale section that focuses specifically on why certain ideas were not ultimately pursued.

## Open Issues

Open issues (not required for implementation current HIP) are allowing users of web3 applications to provide partial imformation to the dapp. For example implementation of a wallet permissions schema and protocol. [EIP2255](https://eips.ethereum.org/EIPS/eip-2255) is a good resource for this.

## References

- [0] https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md
- [1] https://docs.hedera.com/guides/docs/hedera-api
- [3] https://eips.ethereum.org/EIPS/eip-1102#eth_requestaccounts
- [4] https://www.w3.org/TR/REC-DOM-Level-1/introduction.html#
- [5] https://github.com/NoahZinsmeister/web3-react
- [6] https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md

## Copyright/license

This document is licensed under the Apache License, Version 2.0 -- see [LICENSE](../LICENSE) or (https://www.apache.org/licenses/LICENSE-2.0)
